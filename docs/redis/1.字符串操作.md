---
id: 字符串操作
title: 本文内容
sidebar_label: 字符串操作
---



## 分布式锁的要点

- 使用 NX 选项占坑：只有一个线程能够设置成功
- 加上 EX 选项过期时间：防止有线程占据锁之后挂掉了，不删除对锁的占有
- SET 的时候设置值为随机数，释放锁的时候（删除这个 key）只释放与自己占有锁的时候设置的随机数相等的 key
  - 这一步是为了防止自己占有的锁被超时释放后，自己再去释放的时候把别人重新上的锁给删了
- 上一步 `比较随机数` + `删除锁`，不是原子操作，需要通过 lua 脚本来写成原子操作

> 相关实现：redisson、redlock





